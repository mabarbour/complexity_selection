---
title: Food-web complexity flattens the fitness landscape of an insect herbivore
author:
  - name: Matthew A. Barbour
    email: matthew.barbour@ieu.uzh.ch
    affiliation: Department of Evolutionary Biology and Environmental Studies, University of Zurich, Zurich, Switzerland
    footnote: Corresponding Author
  - name: Jordi Bascompte
    email: jordi.bascompte@ieu.uzh.ch
    affiliation: Another University
address:
  - code: Some Institute of Technology
    address: Department, Street, City, State, Zip
  - code: Another University
    address: Department, Street, City, State, Zip
abstract: 
  Studies of natural selection and fitness landscapes usually treat the network of interacting species as a “black box”. Given that the loss of biodiversity is simplifying the structure of ecological networks, there is a pressing need to answer the question: how does network complexity affect natural selection and the fitness landscape of associated species? To answer this question, we conducted a field experiment that manipulated the complexity of a food web associated with a galling insect herbivore. To maintain complex food webs, we allowed the entire community of natural enemies to attack insect galls on 64 plants in a common garden setting. To create simple food webs, we excluded a guild of three larval parasitoids by bagging galls on 64 different plants; therefore, mortality in this treatment was primarily due to a single egg parasitoid that attacks prior to gall formation. We then measured herbivore survival as a function of three key gall traits in each treatment. We found that more traits were under selection in the simple vs. complex food web. This occurred because different parasitoid species impose different selection pressures on gall traits, thereby minimizing relative fitness differences among insect galls with different phenotypes. Our work suggests that more complex food webs allow phenotypic variation to persist, which could facilitate subsequent adaptive evolution to environmental change. Species-interaction networks provide a mechanistic link between community and population ecology, as they describe who interacts with whom in a community. Similarly, fitness landscapes provide a mechanistic link between population and evolutionary ecology, as they describe the influence of natural selection on phenotypic variation. It remains unclear, however, how the network structure of species interactions shapes the fitness landscape. Understanding this relationship is likely key for developing a predictive ecology across scales of biological organization. To examine the relationship between network structure and the fitness landscape, we conducted a field experiment that manipulated the network of trophic interactions (simple vs. complex) influencing the fitness of an insect herbivore. We then quantified the fitness landscape of herbivores in each treatment by measuring herbivore survival as a function of multiple phenotypic traits. We found that more traits were under selection in the simple vs. complex trophic network. This occurred because different natural enemies impose different selection pressures on herbivore traits, thereby minimizing relative fitness differences among herbivore phenotypes in the complex network. Our work suggests that more complex trophic networks allow phenotypic variation to persist, which could facilitate subsequent adaptive evolution of populations to environmental change.

bibliography: mybibfile.bib
output: rticles::elsevier_article
---

_Text based on elsarticle sample manuscript, see [http://www.elsevier.com/author-schemas/latex-instructions#elsarticle](http://www.elsevier.com/author-schemas/latex-instructions#elsarticle)_

```{r setup, include=FALSE}

## Load required libraries ----
library(tidyverse)
library(cowplot) # pretty default ggplots
library(broom) # for tidying multiple linear models
library(mgcv) # generalized additive models
library(gamm4) # generalized additive mixed-models
library(gsg) # calculating selection gradients
library(visreg)
library(viridis) # for color palette

## Load and manage data ----

gall_selection.df <- read_csv("gall_selection_data.csv") %>%
  # convert appropriate variables to characters instead of integers
  mutate(Plant_Position = as.character(Plant_Position),
         Gall_Number = as.character(Gall_Number)) %>%
  unite(Gall_ID, Gall_Number, Gall_Letter, remove = FALSE) %>%
  
  # subset data for analysis
  filter(phenology == "early", Location == "tree",
         platy > 0 | ectos > 0 | pupa > 0) %>%                  # eliminate unknown sources of mortality
  mutate(gall_survival = as.numeric(ifelse(pupa > 0, 1, 0)),
         egg_parasitoid = as.numeric(ifelse(platy > 0, 1, 0))) 

# convert treatment to factor to use as 'by' variable in generalized additive models
gall_selection.df <- gall_selection.df %>%
  mutate(Treatment_contr.sum=factor(Treatment.focus), 
         sc.gall_size = as.numeric(scale(Gall_Height_mm)),
         sc.clutch_size = as.numeric(scale(gall_individuals)),
         sc.female_preference = as.numeric(scale(Density_per_100_shoots)))
contrasts(gall_selection.df$Treatment_contr.sum) <- 'contr.sum'

## Create separate datasets for quantifying selection gradients ----
control_df <- gall_selection.df %>%
  filter(Treatment.focus == "Control") %>%
  mutate(sc.gall_size = (Gall_Height_mm - mean(Gall_Height_mm))/sd(Gall_Height_mm),
         sc.clutch_size = (gall_individuals - mean(gall_individuals))/sd(gall_individuals),
         sc.female_preference = (Density_per_100_shoots - mean(Density_per_100_shoots))/sd(Density_per_100_shoots))

treatment_df <- gall_selection.df %>%
  filter(Treatment.focus == "Ectoparasitoid exclusion") %>%
  mutate(sc.gall_size = (Gall_Height_mm - mean(Gall_Height_mm))/sd(Gall_Height_mm),
         sc.clutch_size = (gall_individuals - mean(gall_individuals))/sd(gall_individuals),
         sc.female_preference = (Density_per_100_shoots - mean(Density_per_100_shoots))/sd(Density_per_100_shoots))

## Custom functions to avoid repetitive code ----
gamm.model <- function(formula, data) {
  gamm4(formula, data, 
        random = ~(1|Genotype/Plant_Position/Gall_Number), 
        family = binomial(link = logit))
}

gam.plot <- function(gam.model, ...) {
  plot(gam.model, se = TRUE, seWithMean = T, shift = mean(predict(gam.model)), trans = function(x) {exp(x)/(1+exp(x))}, ...)
}

# experimenting with boot.case gave bootstrapped distributions that weren't centered near the model mean estimate.
# also, using 'refit.smooth = T' also generated some very skewed distributions
# the recipe below provided the most sensible estimates for my data
gradient.calc <- function(mod, phenotype, covariates = NULL) {
  gam.gradients(mod, phenotype, covariates, parallel = 'multicore', ncpus = 32, 
                refit.smooth = F,
                n.boot = 1000,
                se.method = 'boot.para', #'posterior', #'boot.para', #'permute', 'boot.case'#  
                standardized = T)
} 

insect_FL <- function(mod, phenotype, covariates = NULL) {
  fitness.landscape(mod, phenotype, covariates, parallel = 'multicore', ncpus = 32,
                    PI.method = 'boot.para',
                    refit.smooth = F,
                    PI.interval = c(0.025,0.975),
                    plt.density = 100)
}

get_insect_FL.df <- function(FL){
  data.frame(mean_fitness = FL$Wbar, FL$points, t(FL$WbarPI)) %>%
    mutate(lower_2.5 = X2.5., upper_97.5 = X97.5.)
}

overdisp_fun <- function(model) {
  ## number of variance parameters in 
  ##   an n-by-n variance-covariance matrix
  vpars <- function(m) {
    nrow(m)*(nrow(m)+1)/2
  }
  model.df <- sum(sapply(VarCorr(model),vpars))+length(fixef(model))
  rdf <- nrow(model.frame(model))-model.df
  rp <- residuals(model,type="pearson")
  Pearson.chisq <- sum(rp^2)
  prat <- Pearson.chisq/rdf
  pval <- pchisq(Pearson.chisq, df=rdf, lower.tail=FALSE)
  c(chisq=Pearson.chisq,ratio=prat,rdf=rdf,p=pval)
}

inverse_logit <- function(x) exp(x)/(1+exp(x))

#Beta_avg_grad <- function(logistic_model, mean_fitness) {
#  brackets <- predict(logistic_model, type = "response") * (1 - predict(logistic_model, type="response"))
#  gradient <- mean(brackets) * fixef(logistic_model) / mean_fitness 
#  return(gradient)
#}

## Calculate directional selection gradients
# following method of Janzen and Stern 1998, Evolution
Beta_avg_grad <- function(.) {
  mean_fitness <- inverse_logit(fixef(update(., .~. -sc.gall_size -sc.clutch_size -sc.female_preference)))
  brackets <- predict(., type = "response") * (1 - predict(., type="response"))
  mean(brackets) * fixef(.)[-1] / mean_fitness 
}

## Bootstrap fitness estimates
bootstrap_fitness <- function(logistic_model, newdata, bootstraps, intervals=c(0.025,0.975)){
  model_matrix <- model.matrix(~ sc.gall_size + sc.clutch_size + sc.female_preference, newdata)
  
  # Absolute fitness
  get_absolute_fitness <- function(.) inverse_logit(model_matrix %*% fixef(.))
  
  if(is.null(bootstraps) == FALSE){
    get_bootstraps_absolute_fitness <-bootMer(logistic_model, FUN = get_absolute_fitness, nsim=bootstraps, parallel="multicore", ncpus=32)
  
   get_intervals_absolute_fitness <- apply(get_bootstraps_absolute_fitness$t, 2, function(x) x[order(x)][c(round(bootstraps*intervals[1],0),round(bootstraps*intervals[2],0))])
   
  absolute_fitness_df <- data.frame(newdata, 
                    average = get_absolute_fitness(logistic_model), 
                    lower = get_intervals_absolute_fitness[1, ],
                    upper = get_intervals_absolute_fitness[2, ],
                    t(get_bootstraps_absolute_fitness$t))
  } else {
    absolute_fitness_df <- data.frame(newdata, 
                    average = get_absolute_fitness(logistic_model))
  }
  
  
  # Relative fitness
  get_relative_fitness <- function(.) get_absolute_fitness(.)/mean(get_absolute_fitness(.))
  
  if(is.null(bootstraps) == FALSE){
    get_bootstraps_relative_fitness <-bootMer(logistic_model, FUN = get_relative_fitness, nsim=bootstraps, parallel="multicore", ncpus=32)
  
  get_intervals_relative_fitness <- apply(get_bootstraps_relative_fitness$t, 2, function(x) x[order(x)][c(round(bootstraps*intervals[1],0),round(bootstraps*intervals[2],0))])
    
  relative_fitness_df <- data.frame(newdata, 
                    average = get_relative_fitness(logistic_model), 
                    lower = get_intervals_relative_fitness[1, ],
                    upper = get_intervals_relative_fitness[2, ],
                    t(get_bootstraps_relative_fitness$t))
  } else {
      relative_fitness_df <- data.frame(newdata, 
                    average = get_relative_fitness(logistic_model))
  }
  
  # Organize data
  return(list(absolute_fitness = absolute_fitness_df, relative_fitness = relative_fitness_df))
}
```



Introduction
============

<!-- Alternative intro, "the fitness landscape as the unifying concept between ecology and evolutionary biology "-->

<!-- I. Community context can affect evolutionary change -->

Biological diversity -- from genes, to phenotypes, to species -- has fascinated evolutionary biologists for decades. <!-- need to improve this instead of just saying its fascinated a small group of people --> Much of this biological diversity has been shaped by natural selection via trophic interactions, such as resource competition (@Schluter2000), mutualistic exchanges of resource (@Jordano1987), and predation (@Abrams2000). While there is clear evidence for pairwise trophic interactions to drive evolution by natural selection, we also know that many species are embedded within complex networks of interacting species. <!-- need to make the link to multiple traits and the adaptive landscape here --> Nevertheless, the dynamics of natural selection in species-rich communities remains poorly explored (@McPeek2017). 

More recently, researchers have begun to explore how the community context drives evolutionary change (@McPeek2017; @TerHorst2018). 

NEED to recognize that evolutionary biologists have begun to explore how community context affects evolutionary change (work by Sharon Strauss, Casey terHorst, Lutz Becks, etc.). These results have begun to show interesting patterns whereby the composition of species in a community can alter the direction and strength of natural selection imposed on species embedded within these communities (cite). 

In other words, these results have begun to illustrate show how biological diversity, in terms of differences between species, can shape evolution. Nevertheless, predicting the how the composition of species in a community requires moving beyond a description of community composition. simply knowing the composition of species in a community will 

<!-- II. Still unclear how biological diversity shapes evolutionary change -->

Predicting the effects of biological diversity on requires an explicit examination of the network structure of trophic interactions between species in a community. Theoretical models have begun to examine how the network structure of species interactions drives evolutionary change (Nuismer paper; Guimeras paper; Ecology Letters paper from a spanish guy...; @McPeek2017); however, we are currently lacking experimental tests. 

<!-- II. Ecologists have incorporated community context --> 

<!-- In contrast, ecologists have begun to embrace the complexity of the natural world, and seeking to identify the complex networks of interactions that underlie community structure and ecosystem function. However, these studies have not examined how evolutionary processes feedback to shape the structure and evolution of these interaction networks. -->

<!-- III. Generate expectations for how food-web complexity may alter selection gradients -->

Food-web complexity can shape the fitness landscape in at least two ways. First, if more diverse predator communities are more efficient at suppressing prey densities (e.g. biodiversity-ecosystem fucntion; Ives 2005 Ecology Letters), then this will result in lower mean fitness. A reduction in mean fitness, all else equal, will intensify natural selection (@Hunter2018) and thus could speed up the rate of evolutionary change. Alternatively, if predators are functionally distinct, more diverse communities can reduce the strength of selection. This is because each predator has a different functional relationship between prey phenotype and the probability of an interaction. 

<!-- IV. Introduce study system -->

Here, we conducted a field experiment to test the effect of network complexity on the fitness landscape of a constituent species. To do this, we used a common garden experiment with a host plant (*Salix hooeriana*), an abundant herbivore (*Iteomyia salicisverruca*), and the diverse community of insect parasitoids that attack it. Prior work in this system has shown that there is directional selection for larger galls, likely because larger galls provide more of a refuge from parasitoid attack. However, there is also evidence that different parasitoid species impose differential selection on gall phenotypes.  

<!-- IV. Relationship between entropy and fitness landscape 
In more complex communities, there is greater uncertainty for an individual prey in which predator species will be imposing the trophic interaction. This also means the --> 



Materials & Methods
===================

## Study Site

<!-- I. Give details about the study site, but not focusing on the genetic variation since this doesn't play much of a role in this manuscript. -->

We conducted our study within a four-year old common garden of coastal willow (*Salix hookeriana*) located at Humboldt Bay National Wildlife Refuge (HBNWR) (40&deg;40'53"N, 124&deg;12'4"W) near Loleta, California, USA. This common garden consists of 26 different willow genotypes that were collected from a single population of willows growing around Humboldt Bay. <!--While relatedness among these genotypes is unknown, their phenotypes in multivariate trait space are quite distinct from each other (@Barbour2016), suggesting that we can treat them as independent from one another.--> Stem cuttings of each genotype (25 replicates per genotypes) were planted in a completely randomized design in two hectares of a former cattle pasture at HBNWR. Willows in our garden begin flowering in February and reach their peak growth in early August. During this study, willows had reached 5 - 9m in height. Further details on the genotyping and planting of the common garden are available in @Barbour2015. 

## Food-Web Manipulation

<!-- II. Describe the food-web manipulation experiment --> 

We setup our food-web manipulation across 128 plants soon after galls began developing on *S. hookeriana* in early June of 2013. 
These 128 plants came from eight different plant genotypes, spanning the range of trait variation observed in this willow population (@Barbour2015). 
On treatment plants (8 replicates per genotype), we enclosed 14 galled leaves with organza bags (MANUFACTORER DETAILS) to exclude three parasitoid species that attack during larva development (hereafter larval parasitoids). 
This treatment did not exclude the egg parasitoid *Platygaster* sp. which attacks prior to gall initiation (note that in Cecidomyiid midges, larva initiate gall development CITE). 
On control plants (8 replicates per genotype), we used flagging tape to mark 14 galled leaves per plant, allowing the full suite of parasitoids to attack *Iteomyia*. 
Marking galls with flagging tape ensured that we compared control and treatment galls with similar phenology when we collected galls later in the season. 
Our food-web manipulation altered the average number of trophic interactions that *Iteomyia* was exposed to from BLANK on control plants to BLANK on treatment plants. 
Thus, we refer to galls on control plants as being exposed to a 'complex' food web, whereas galls on treatment plants were exposed to a 'simple' food web.
In late August, we collected marked and bagged galls from each plant, placed them into 30 mL vials and <!-- allowed them to complete development--> kept them in the lab for 4 months at room temperature. 
We then opened galls under a dissecting scope and determined whether larva survived to pupation (our measure of fitness) or were parasitized. 

## Measuring Gall Traits

<!-- % III. Describe how we measured gall phenotypes -->

We collected data on three different traits that we anticipated would experience selection based on our previous work (@Barbour2016) and others work with Cecidomyiid midges (@Weis1983, @Heath2018). 
First, we measured gall diameter as the size of each gall chamber to the nearest 0.01 mm at its maximum diameter (perpendicular to the direction of plant tissue growth). 
Our previous work has shown that a larger gall diameter provides a refuge for larva from parasitoid attack (@Barbour2016). <!-- Consider whether it is important to make the distinction that diameter was measured at the multi-chambered gall level in previous work -->
Second, we measured the clutch size of adult female midges by counting the number of chambers in each gall (@Weis1983). 
All larva collected from the same multi-chambered gall were scored with the same clutch size. 
Third, we measured female preference for oviposition (egg-laying) sites as the density of larva observed on a plant.
The measurement of larval densities on plants in the field is a commonly used index for measuring oviposition preference (@Gripenberg2010), although caution must be taken in inferring 'preference' (@Singer1986). 
This is because larval densities can be influenced by processes other than preference. 
For example, if an ovipositing female is not exposed to the full spectrum of plant types (in this case genotypes), then it is difficult to infer whether patterns of larval densities are actually due to <!--dispersal limitation or-->preference. Also, observed larval densities could be influenced by egg predation.    
While we recognize these limitations, a couple of aspects of our study system likely alleviate these limitations. 
For example, since our data comes from a randomized placement of willow genotypes in a common garden, there is no consistent bias in which willow genotypes that females are exposed to while searching for oviposition sites. 
Although we cannot control for egg predation, this source of mortality appears to play comparatively minor role in determining the mortality of galling insects (@Hawkins1997). <!-- and that we can still detect the presence of an individual even if it dies before development (empty chamber lacking an exit hole and without any evidence of larva or parasitoid). -->
To quantify female preference (gall density), we randomly sampled five branches per tree and summed the number of individual gall chambers observed.
We converted these counts to a measure of gall density per 100 shoots by counting the number of shoots on the last branch we sampled.
<!-- To account for potential differences in the number of shoots per branch for each plant genotype (CITE other willow work), we then counted the number of shoots on the fifth branch to estimate the number of larva per 100 shoots for each plant.--> 
All larva collected from the same plant were scored with the same female preference. 


## Statistical Analyses

<!-- % IV. Describe statistical analysis to test the effects of food-web complexity -->

To characterize the shape of the fitness landscape, we quantified selection gradients acting on each trait in simple vs. complex food webs. We did this by fitting separate statistical models to data from each food-web treatment. We used generalized linear mixed models (GLMMs, @Bolker2009) with larval survival (0 or 1) as our response variable and measure of fitness. We specified linear and quadratic terms for each gall trait as well as linear interaction terms between each gall trait, as fixed effects in the statistical models. To account for the correlated structure of clutch size (gall level) and female preference (plant level) as well as any other independent effects of willow genotype on larval survival, we specified gall ID nested within plant ID nested within plant genotype as random intercepts in our statistical models. Since we were interested in characterizing the fitness landscape -- the relationship between mean trait values and population mean fitness -- we assumed the mean value of our random effects (i.e. setting them to zero) to estimate selection gradients. We then used the method of @Janzen1998 to calculate directional ($\beta_{z_i}$), nonlinear ($\gamma_{z_i}$), and correlational ($\gamma_{z_i,z_j}$) selection gradients and used parametric bootstrapping (1000 replicates) to calculate their 95% confidence intervals (@Bolker2009). To test whether selection gradients differed between treatments, we used our bootstrapped estimates to calculate the probability that selection gradients in the simple food web were larger/smaller than in the complex food web (i.e. the p-value). All analyses and visualizations were conducted in R. 

```{r Selection Gradients - Complex Food Web, cache=TRUE}
# note that I've switched to using the lme4 package to analyzing the GLMM

# GLMM ----
glmer_control <- glmer(gall_survival ~ sc.gall_size + sc.clutch_size + sc.female_preference +
                         I(sc.gall_size^2) + I(sc.clutch_size^2) + I(sc.female_preference^2) +
                         sc.gall_size:sc.clutch_size + sc.gall_size:sc.female_preference + sc.clutch_size:sc.female_preference +
                           (1|Genotype/Plant_Position/Gall_Number),
                         data = control_df,
                         family = binomial(link = logit), optimizer = "bobyqa")
# summary(glmer_control)

# Mean fitness ----
Wbar_control <- inverse_logit(fixef(update(glmer_control, .~. -sc.gall_size -sc.clutch_size -sc.female_preference)))

# Confidence intervals for selection gradients ----
boot_Beta_control <- bootMer(glmer_control, FUN = Beta_avg_grad, nsim=100, parallel="multicore", ncpus=32)

## Summary ----
summary_Beta_glmm_control <- data.frame(
  Phenotype = c("Gall size", "Clutch size", "Female preference"),
  Food_Web = "Complex",
  Model = "GLMM",
  Beta = round(Beta_avg_grad(glmer_control),3),
  lower_2.5 = round(apply(boot_Beta_control$t, 2, FUN = function(bootstraps) quantile(bootstraps, 0.025)),3),
  upper_97.5 = round(apply(boot_Beta_control$t, 2, FUN = function(bootstraps) quantile(bootstraps, 0.975)),3)) 

summary_Beta_glmm_control
```


```{r Selection Gradients - Simple Food Web, cache=TRUE}

## GLMM ----
glmer_treatment <- glmer(gall_survival ~ sc.gall_size + sc.clutch_size + sc.female_preference +
                         I(sc.gall_size^2) + I(sc.clutch_size^2) + I(sc.female_preference^2) +
                         sc.gall_size:sc.clutch_size + 
                          sc.gall_size:sc.female_preference + 
                           sc.clutch_size:sc.female_preference +
                           (1|Genotype/Plant_Position/Gall_Number),
                         data = treatment_df,
                         family = binomial(link = logit), optimizer = "bobyqa")
summary(glmer_treatment)

## Mean fitness ----
Wbar_treatment <- inverse_logit(fixef(update(glmer_treatment, .~. -sc.gall_size -sc.clutch_size -sc.female_preference)))

## Confidence intervals for selection gradients ----
boot_Beta_treatment <- bootMer(glmer_treatment, FUN = Beta_avg_grad, nsim=100, parallel="multicore", ncpus=32)

## Summary ----
summary_Beta_glmm_treatment <- data.frame(
  Phenotype = c("Gall size", "Clutch size", "Female preference"),
  Food_Web = "Simple",
  Model = "GLMM",
  Beta = round(Beta_avg_grad(glmer_treatment),2),
  lower_2.5 = round(apply(boot_Beta_treatment$t, 2, FUN = function(bootstraps) quantile(bootstraps, 0.025)),2),
  upper_97.5 = round(apply(boot_Beta_treatment$t, 2, FUN = function(bootstraps) quantile(bootstraps, 0.975)),2)) 

summary_Beta_glmm_treatment
```

<!--$$logit(E(W))=\mu+\beta_{diameter}+\beta_{clutch}+\beta_{preference}+$$
$$logit(E(W))=\mu+treatment+s(diam):treat+s(clutch)+s(pref)+diam:cluch+diam:pref+clutch:pref+(1|Genotype/Plant/Gall)$$-->

<!-- We used generalized linear mixed models (GLMMs, @Bolker2009) to test the effects of food-web complexity on the shape of the fitness landscape. 
Larva survival (0 or 1) was our response variable and measure of fitness. 
<!-- Need to clean up the language part of this section without it being too complicated and confusing. I should also include tests of non-linear selection gradients. -->
<!-- We specified our food-web treatment, each gall trait, two-way interactions between gall traits, as well interactions between gall trait and food-web treatment, as fixed effects to fully explore the effects of food-web complexity on the fitness landscape. 
This analysis implicitly assumes that selection is linear, which we felt was a necessary trade-off for exploring the shape of the fitness landscape. 
To account for the correlated structure of clutch size (gall level) and female preference (plant level) as well as any other independent effects of willow genotype on parasitism rates, we specified gall ID nested within plant ID nested within plant genotype as random intercepts in our statistical models. 
<!-- To identify the appropriate level of model complexity for testing the effects of food-web complexity on the fitness landscapes, we compared models using Aikaike Information Criteria. 
The maximal complexity we explored was a generalized additive mixed model that fit cubic splines to each trait as well as linear interactions between a maximum of two traits as well as an interaction with food-web treatment. -->

<!-- We used a spline-based semiparametric regression (Schluter 1988, Morrissey and Sakedra 2014). These analyses are desirable because they lead to inferences of the form of selection that make few \textit{a priori} assumptions (Schluter 1988), and can now be used to quantify standardized selection gradients (Morrissey and Sakrera 2014).

We then calculated selection gradients as the partial derivatives in absolute fitness (larva survival) with response to multivariate phenotype using the \textit{gsg} package in R (cite Morrissey and R project). We standardized phenotypes (mean=0, SD=1), so that first-order derivatives correspond to the intensity of directional selection ($\beta$\textsubscript{trait}), while second-order derivatives correspond to intensity of nonlinear ($\gamma$\textsubscript{trait}) and correlational selection ($\gamma$\textsubscript{trait$_i$,}\textsubscript{trait$_j$}) and are thus comparable within this study as well as to others. -->

<!-- Our GLMMs are useful for testing the effects of food-web complexity on the fitness landscape within the context of our experimental design; however, coefficients from GLMMs cannot be easily converted into quantitative estimates of selection gradients (cite Morrissey's work). Therefore, for each treatment, we fit separate generalized additive models (GAMs) for gall traits that we identified as being under selection from our GLMMs. Estimating selection gradients from GAMs can give insight to both linear and non-linear selection gradients, which we assumed were all linear for our GLMMs, given the complexity of already fitting up to 4-way interactions in these models. For the number of larva per gall and gall density, we aggregated larva survival at the gall or plant level, respectively, to avoid pseudoreplication in our GAMs. -->



Results
=======

<!-- Consider exploring whether there is a linear or non-linear relationship between food-web complexity and the strength of selection. I think I could do this simply by calculating the index of food-web complexity measured on each plant. Perhaps it would also be good to measure to calculate the selection gradient observed on each plant -->

We found that more phenotypic traits were under selection in the simple vs. complex food web. In both complex and simple food webs, gall diameter was under strong directional selection, with larger galls resulting in higher larval survival (complex Beta = ; simple Beta = )(Fig. 2A). In complex food webs, there was no evidence of selection on clutch size ($\beta_{clutch}=$) or female preference ($\beta_{preference}=$)(orange lines in Fig. 2B,C). In simple food webs, however, clutch size and female preference were under strong directional selection, with smaller clutch sizes and weaker preferences resulting in higher larval survival (blue lines in Fig. 2B,C). These different selection pressures resulted in different adaptive landscapes in complex vs. simple food webs, with evidence for more rugged landscapes in the simple rather than the complex food web (Fig. 3). Depending on the trait combinations used to create the landscape, we found that the ruggedness of the adaptive landscape ranged from 10\% higher (Fig. 3A) to 274\% higher (Fig. 3C) in the simple vs. complex food web. Our model comparison suggested that it was unnecessary to test for the effects of non-linear or correlational selection gradients (ref. supp. mat.).

Discussion
==========


<!-- Feedbacks between biological diversity and evolutionary change -->

There are various bibliography styles available. You can select the
style of your choice in the preamble of this document. These styles are
Elsevier styles based on standard styles like Harvard and Vancouver.
Please use BibTeX to generate your bibliography and include DOIs
whenever available.

Here are two sample references: @Feynman1963118 [@Dirac1953888].

References {#references .unnumbered}
==========
